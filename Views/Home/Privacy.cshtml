@{
    ViewData["Title"] = "Đấu thầu";
}
<h1>@ViewData["Title"]</h1>




<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en">
<!--<![endif]-->
<head>
<APM_DO_NOT_TOUCH>

<script type="text/javascript">
(function(){
window.mOqv=!!window.mOqv;try{(function(){(function(){var z={decrypt:function(z){try{return JSON.parse(function(z){z=z.split("l");var s="";for(var _=0;_<z.length;++_)s+=String.fromCharCode(z[_]);return s}(z))}catch(_){}}};return z={configuration:z.decrypt("123l34l97l99l116l105l118l101l34l58l34l110l111l34l44l34l100l101l98l117l103l103l105l110l103l34l58l34l110l111l34l44l34l109l111l100l117l108l101l49l34l58l34l101l110l97l98l108l101l100l34l44l34l109l111l100l117l108l101l50l34l58l34l101l110l97l98l108l101l100l34l44l34l109l111l100l117l108l101l51l34l58l34l101l110l97l98l108l101l100l34l44l34l109l111l100l117l108l101l52l34l58l34l101l110l97l98l108l101l100l34l125")}})();
var _z=34;try{var Iz,Jz,Lz=Z(42)?0:1,zZ=Z(423)?0:1,SZ=Z(26)?0:1,JS=Z(958)?0:1,LS=Z(712)?0:1,OS=Z(975)?0:1,Z_=Z(520)?0:1;for(var _Z=(Z(574),0);_Z<Jz;++_Z)Lz+=Z(453)?1:2,zZ+=(Z(556),2),SZ+=Z(503)?1:2,JS+=Z(178)?1:2,LS+=(Z(896),2),OS+=(Z(416),2),Z_+=Z(600)?1:3;Iz=Lz+zZ+SZ+JS+LS+OS+Z_;window.JI===Iz&&(window.JI=++Iz)}catch(JZ){window.JI=Iz}var LZ=!0;function I(z){var s=arguments.length,_=[],l=1;while(l<s)_[l-1]=arguments[l++]-z;return String.fromCharCode.apply(String,_)}
function oZ(z){var s=83;!z||document[I(s,201,188,198,188,181,188,191,188,199,204,166,199,180,199,184)]&&document[S(s,201,188,198,188,181,188,191,188,199,204,166,199,180,199,184)]!==J(68616527583,s)||(LZ=!1);return LZ}function J(z,s){z+=s;return z.toString(36)}function S(z){var s=arguments.length,_=[];for(var l=1;l<s;++l)_.push(arguments[l]-z);return String.fromCharCode.apply(String,_)}function zs(){}oZ(window[zs[S(_z,144,131,143,135)]]===zs);oZ(typeof ie9rgb4!==S(_z,136,151,144,133,150,139,145,144));
oZ(RegExp("\x3c")[J(1372171,_z)](function(){return"\x3c"})&!RegExp(J(42855,_z))[J(1372171,_z)](function(){return"'x3'+'d';"}));
var Zs=window[I(_z,131,150,150,131,133,138,103,152,135,144,150)]||RegExp(I(_z,143,145,132,139,158,131,144,134,148,145,139,134),I(_z,139))[S(_z,150,135,149,150)](window["\x6e\x61vi\x67a\x74\x6f\x72"]["\x75\x73e\x72A\x67\x65\x6et"]),_s=+new Date+(Z(316)?351419:6E5),is,Is,Js,ls=window[I(_z,149,135,150,118,139,143,135,145,151,150)],Os=Zs?Z(749)?33111:3E4:Z(356)?3675:6E3;
document[S(_z,131,134,134,103,152,135,144,150,110,139,149,150,135,144,135,148)]&&document[S(_z,131,134,134,103,152,135,144,150,110,139,149,150,135,144,135,148)](I(_z,152,139,149,139,132,139,142,139,150,155,133,138,131,144,137,135),function(z){var s=63;document[S(s,181,168,178,168,161,168,171,168,179,184,146,179,160,179,164)]&&(document[I(s,181,168,178,168,161,168,171,168,179,184,146,179,160,179,164)]===J(1058781920,s)&&z[I(s,168,178,147,177,180,178,179,164,163)]?Js=!0:document[S(s,181,168,178,168,
161,168,171,168,179,184,146,179,160,179,164)]===S(s,181,168,178,168,161,171,164)&&(is=+new Date,Js=!1,ZS()))});function ZS(){if(!document[I(56,169,173,157,170,177,139,157,164,157,155,172,167,170)])return!0;var z=+new Date;if(z>_s&&(Z(164)?881496:6E5)>z-is)return oZ(!1);var s=oZ(Is&&!Js&&is+Os<z);is=z;Is||(Is=!0,ls(function(){Is=!1},Z(521)?0:1));return s}ZS();var sS=[Z(606)?17735832:17795081,Z(762)?2147483647:27611931586,Z(362)?968273035:1558153217];
function _S(z){var s=8;z=typeof z===I(s,123,124,122,113,118,111)?z:z[S(s,124,119,91,124,122,113,118,111)](Z(379)?47:36);var _=window[z];if(!_||!_[I(s,124,119,91,124,122,113,118,111)])return;var l=""+_;window[z]=function(z,s){Is=!1;return _(z,s)};window[z][I(s,124,119,91,124,122,113,118,111)]=function(){return l}}for(var iS=(Z(530),0);iS<sS[J(1294399171,_z)];++iS)_S(sS[iS]);oZ(!1!==window[S(_z,143,113,147,152)]);window.oi=window.oi||{};window.oi.jSs="082a8752ac16e8008f1af511cfae32ba2757a2bdab2027b75662bb1e1d4d96f0c3583f705708eb03b0404aceb9ea58e781f80cfda74a4034f64db698fc93f8ebc327423b39ef2adfde70d150038de6bf9faf5a91c8ac76532d20dfdd1e219872762e00d9195f9620167b8847412d62f88691ed73087b4a55b825fccbd32ada94d30d7556ad167c859b7fb2bd7d1f03e465db52e8c6c5301c704aff66558234a5b10cfc55f43c234176c8f9552e7304f10d3593481935d5645b2f3654b990488fe1481ef9ab32b60529dc3172ae86bc812abd343cd3c626ba213d4915955f4aac9157c7199af61f6f9f1ae24c7b9483d1";
function IS(z){var s=+new Date,_;!document[I(90,203,207,191,204,211,173,191,198,191,189,206,201,204,155,198,198)]||s>_s&&(Z(587)?485985:6E5)>s-is?_=oZ(!1):(_=oZ(Is&&!Js&&is+Os<s),is=s,Is||(Is=!0,ls(function(){Is=!1},Z(961)?0:1)));return!(arguments[z]^_)}function Z(z){return 13>z}(function s_(s){s&&"number"!==typeof s||("number"!==typeof s&&(s=1E3),s=Math.max(s,1),setInterval(function(){s_(s-10)},s))})(!0);})();}catch(x){}finally{ie9rgb4=void(0);};function ie9rgb4(a,b){return a>>b>>0};

})();

</script>
</APM_DO_NOT_TOUCH>

<script type="text/javascript" src="/TSPD/082d638fd6ab200068afd070d0c9498d3735077bd154b5d710f1da71d0c0218eaa4a750574ff5251?type=17"></script>

    <!-- Meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="/favicon.ico">
    <!-- Global CSS -->
    <link rel="stylesheet" href="/Content/bootstrap-box.min.css">
    <link href="/Content/datepicker/css/bootstrap-datetimepicker.min.css" rel="stylesheet">
    <!-- Plugins CSS -->
    <link href="/Content/font-awesome.css" rel="stylesheet">
    <link href="/Content/tn3/tn3.css" rel="stylesheet">
    <link href="/Content/styles-box.css" rel="stylesheet">
    <link href="/Content/custom.css" rel="stylesheet">


    <!-- Theme CSS -->
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="/Scripts/html5shiv.js"></script>
        <script src="/Scripts/respond.min.js"></script>
    <![endif]-->

</head>

<body class="home-page boxed">
    <style>
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #FFFFFF;
            -webkit-box-shadow: inset 1px 1px 2px #E0E0E0;
            border: 1px solid #D8D8D8;
        }

        ::-webkit-scrollbar-thumb {
            background: #36b8ec;
            -webkit-box-shadow: inset 1px 1px 2px rgba(155,155,155,0.4);
        }

            ::-webkit-scrollbar-thumb:hover {
                -webkit-box-shadow: inset 1px 1px 10px rgba(0,0,0,0.3);
            }

            ::-webkit-scrollbar-thumb:active {
                background: #888;
                -webkit-box-shadow: inset 1px 1px 2px rgba(0,0,0,0.3);
            }
    </style>
 

<section class="events list" style="padding:15px;">
    <div class="col-md-12 col-xs-12">
        <div class="form-group">
        </div>
    </div>
        <h1 class="line" style="margin:0px;color:#d24400"><span>TH&#212;NG TIN VỀ KẾ HOẠCH MUA SẮM</span></h1>
<form action="/DTCGNT/CreateCGNT" class="formMCG" enctype="multipart/form-data" method="post"><input name="__RequestVerificationToken" type="hidden" value="jEkcbNpYnZRlnShFoiaj27ah8XUCYIKQ8kFVXtYpUyWsut5q-PLq2UpasaUWus2nqyQaYq0q6DFiFpuRjB7KmbI6Lgbeaq9wkqjQaNBaQHM1" /><div class="form-horizontal">
    <input data-val="true" data-val-number="The field DTMCGThongTinNhaThauId must be a number." data-val-required="The DTMCGThongTinNhaThauId field is required." id="DTMCGThongTinNhaThauId" name="DTMCGThongTinNhaThauId" type="hidden" value="0" />
    <input data-val="true" data-val-required="Bắt buộc có" id="GuidTTNT" name="GuidTTNT" type="hidden" value="ec793f79f6464aa4b25af9e5e4700964" />
    <input id="SecretCode" name="SecretCode" type="hidden" value="dffc45" />
    <input data-val="true" data-val-number="The field Mẫu mời chào giá(*): must be a number." data-val-required="Mẫu mời chào giá bắt buộc có" id="DTMCGMauMCGId" name="DTMCGMauMCGId" type="hidden" value="458" />
    <input id="GuidMauMCG" name="GuidMauMCG" type="hidden" value="ef2adf0cb712483aac74f26a43e1b852" />
    <input data-val="true" data-val-date="The field Created must be a date." data-val-required="The Created field is required." id="Created" name="Created" type="hidden" value="24/08/2023 14:37:08" />
    <input data-val="true" data-val-date="The field Updated must be a date." data-val-required="The Updated field is required." id="Updated" name="Updated" type="hidden" value="24/08/2023 14:37:08" />
    <input data-val="true" data-val-number="The field Status must be a number." data-val-required="The Status field is required." id="Status" name="Status" type="hidden" value="2" />
    <br />
    <div class="col-md-12 col-xs-12">
        <div class="col-md-6" style="padding-right:10px;">
            <div class="form-group">
                <label class="control-label col-md-6" style="text-align:left;">Tên dự toán mua sắm(*): </label>
                <div class="col-md-6">
                    <input class="form-control" type="text" value="Cung cấp mỹ phẩm nội tr&#250; năm 2023" readonly="readonly">
                </div>
            </div>
        </div>
        <div class="col-md-6" style="padding-right:10px;">
            <div class="form-group">
                <label class="control-label col-md-6" style="text-align:left;">Năm(*): </label>
                <div class="col-md-6">
                    <input class="form-control" type="text" value="2023" readonly="readonly">
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-12 col-xs-12">
        <div class="col-md-6" style="padding-right:10px;">
            <div class="form-group">
                <label class="control-label col-md-6" style="text-align:left;">Phân loại (*): </label>
                <div class="col-md-6">
                    <select id="PhanLoaiDuAn" name="PhanLoaiDuAn" class="form-control" disabled="disabled">
                            <option value="0">Chọn phân loại</option>
                        <option value="1" selected=&quot;selected&quot;>Hàng hóa thông thường</option>
                        <option value="2" >Máy móc,linh kiện</option>
                        <option value="3" >Vật tư</option>
                        <option value="4" >Hóa chất</option>
                        <option value="5" >Dịch vụ</option>
                        <option value="6" >Thuốc</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="col-md-6" style="padding-right:10px;">
            <div class="form-group">
                <label class="control-label col-md-6" style="text-align:left;">Người liên hệ (*): </label>
                <div class="col-md-6">
                    <input class="form-control" type="text" value="Trần Thị Ho&#224;ng Xu&#226;n" readonly="readonly">
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-12 col-xs-12">
        <div class="col-md-6" style="padding-right:10px;">
            <div class="form-group">
                <label class="control-label col-md-6" style="text-align:left;">Điện thoại liên hệ (*): </label>
                <div class="col-md-6">
                    <input class="form-control" type="text" value="028.3952.5955                 " readonly="readonly">
                </div>
            </div>
        </div>
        <div class="col-md-6" style="padding-right:10px;">
            <div class="form-group">
                <label class="control-label col-md-6" style="text-align:left;">Email liên hệ  (*): </label>
                <div class="col-md-6">
                    <input class="form-control" type="text" value="xuan.tth@umc.edu.vn" readonly="readonly">
                </div>
            </div>
        </div>
    </div>
    <br />
    <h1 class="line" style="margin:0px;color:#d24400"><span>PHẦN CH&#192;O GI&#193; CỦA NH&#192; THẦU</span></h1>

    <br />

    <div class="form-group">
        <label class="col-md-12" style="color:#b94a48">Các trường có dấu (*) bắt buộc nhập.</label>
    </div>
    <div class="col-md-12 col-xs-12">
        <div class="col-md-6" style="padding-right:10px;">
            <div class="form-group">
                <label class="control-label col-md-6" for="TenCongTy" style="text-align:left;">T&#234;n nh&#224; thầu (*): </label>
                <div class="col-md-6">
                    <input class="form-control" data-val="true" data-val-required="Bắt buộc nhập" id="TenCongTy" name="TenCongTy" type="text" value="" />
                    <span class="field-validation-valid" data-valmsg-for="TenCongTy" data-valmsg-replace="true"></span>
                </div>
            </div>
        </div>
        <div class="col-md-6" style="padding-right:10px;">
            <div class="form-group">
                <label class="control-label col-md-6" for="MaSoDoanhNghiep" style="text-align:left;">M&#227; số doanh nghiệp (*): </label>
                <div class="col-md-6">
                    <input class="form-control" data-val="true" data-val-required="Bắt buộc nhập" id="MaSoDoanhNghiep" name="MaSoDoanhNghiep" type="text" value="" />
                    <span class="field-validation-valid" data-valmsg-for="MaSoDoanhNghiep" data-valmsg-replace="true"></span>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-12 col-xs-12">
        <div class="col-md-6" style="padding-right:10px;">
            <div class="form-group">
                <label class="control-label col-md-6" for="NguoiLienHe" style="text-align:left;">Người li&#234;n hệ (*): </label>
                <div class="col-md-6">
                    <input class="form-control" data-val="true" data-val-required="Bắt buộc nhập" id="NguoiLienHe" name="NguoiLienHe" type="text" value="" />
                    <span class="field-validation-valid" data-valmsg-for="NguoiLienHe" data-valmsg-replace="true"></span>
                </div>
            </div>
        </div>
        <div class="col-md-6" style="padding-right:10px;">
            <div class="form-group">
                <label class="control-label col-md-6" for="DienThoaiLienHe" style="text-align:left;">Điện thoại li&#234;n hệ (*): </label>
                <div class="col-md-6">
                    <input class="form-control" data-val="true" data-val-required="Bắt buộc nhập" id="DienThoaiLienHe" name="DienThoaiLienHe" type="text" value="" />
                    <span class="field-validation-valid" data-valmsg-for="DienThoaiLienHe" data-valmsg-replace="true"></span>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-12 col-xs-12">
        <div class="col-md-6" style="padding-right:10px;">
            <div class="form-group">
                <label class="control-label col-md-6" for="EmailLienHe" style="text-align:left;">Email li&#234;n hệ (*): </label>
                <div class="col-md-6">
                    <input class="form-control" data-val="true" data-val-required="Bắt buộc nhập" id="EmailLienHe" name="EmailLienHe" type="text" value="" />
                    <span class="field-validation-valid" data-valmsg-for="EmailLienHe" data-valmsg-replace="true"></span>
                </div>
            </div>
        </div>
        <div class="col-md-6" style="padding-right:10px;">
            &nbsp;
        </div>
    </div>

    <div class="col-md-12 col-xs-12">
        <div class="col-md-6" style="padding-right:10px;">
            <div class="form-group">
                <label class="control-label col-md-6" for="FileScanBaoGiaDongDau" style="text-align:left;">File scan b&#225;o gi&#225;, c&#243; k&#253; t&#234;n, đ&#243;ng dấu (*): </label>
                <div class="col-md-6">
                    <input class="form-control" data-val="true" data-val-required="Bắt buộc nhập" id="FileScanBaoGiaDongDau" name="FileScanBaoGiaDongDau" readonly="readonly" type="text" value="" />
                    <span class="field-validation-valid" data-valmsg-for="FileScanBaoGiaDongDau" data-valmsg-replace="true"></span>

                </div>
            </div>
        </div>
        <div class="col-md-6" style="padding-right:10px;">
            <div class="form-group">
                <input type="file" id="fileUploadPdf" accept='application/pdf' class="form-control" />
            </div>
        </div>
    </div>
    <div class="col-md-12 col-xs-12">
        <div class="col-md-6" style="padding-right:10px;">
            <div class="form-group">
                <label class="control-label col-md-6" for="FileBaoGia" style="text-align:left;">Bảng ch&#224;o gi&#225; của nh&#224; thầu (*): </label>
                <div class="col-md-6">
                    <input class="form-control" data-val="true" data-val-required="Bắt buộc nhập" id="FileBaoGia" name="FileBaoGia" readonly="readonly" type="text" value="" />
                    <span class="field-validation-valid" data-valmsg-for="FileBaoGia" data-valmsg-replace="true"></span>

                </div>
            </div>
        </div>
        <div class="col-md-2" style="padding-right:10px;">
            <div class="form-group">
                <button type="button" class="btn btn-primary btnBieuMauTaiXuong"><span class="glyphicon glyphicon-download">&nbsp;</span>Biểu mẫu tải xuống</button>
            </div>
        </div>
        <div class="col-md-4" style="padding-right:10px;">
            <div class="form-group">
                <input type="file" id="fileUploadXLS" accept='application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' class="form-control" />
            </div>
        </div>
    </div>
    <div class="col-md-12 col-xs-12">
        <div class="col-md-6" style="padding-right:10px;">
            <div class="form-group">
                <label class="control-label col-md-6" for="FileZipDinhKem" style="text-align:left;">File hồ sơ kỹ thuật, file kh&#225;c (.zip): </label>
                <div class="col-md-6">
                    <input class="form-control" id="FileZipDinhKem" name="FileZipDinhKem" type="text" value="" />
                    <span class="field-validation-valid" data-valmsg-for="FileZipDinhKem" data-valmsg-replace="true"></span>

                </div>
            </div>
        </div>
        <div class="col-md-6" style="padding-right:10px;">
            <div class="form-group">
                <input type="file" id="fileUploadZip" accept="application/zip,application/x-zip,application/x-zip-compressed" class="form-control" />
            </div>
        </div>
    </div>
    <div class="col-md-12 col-xs-12">
        <table class="table" id="FilesList" border="1">

            <tbody>
            </tbody>
        </table>
    </div>
    <div class="col-md-12 col-xs-12">
        <div id="excel_data">

        </div>
    </div>

    <div class="form-group">
        <div class="col-md-offset-4 col-md-8">
            <input type="submit" value="Lưu thông tin" class="btn btn-primary" id="CGNTSaveData" />
        </div>
    </div>
</div>
</form></section>


<div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Modal Header</h4>
            </div>
            <div class="modal-body">
                <p>Some text in the modal.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Đóng</button>
            </div>
        </div>
    </div>
</div>


                </div>
            </div>
            <div class="col-md-12 col-sm-12 main-content-no-right-content" id="main-content-no-right-content">
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="myModal" role="dialog">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Modal Header</h4>
                </div>
                <div class="modal-body">
                    <p>Some text in the modal.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Đóng</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ******FOOTER****** -->
    </footer>
    <!-- slidebar right -->
    <!-- *****CONFIGURE STYLE****** -->
    <!-- end slidebar right -->
    <!--//footer-->
    <script language="javascript">
        function ClickWebsiteLink(oSelect) {
            try {
                var index = oSelect.selectedIndex;
                if (index >= 0) {
                    var url = oSelect.options[index].value;
                    if (url != "") {
                        window.open(url, "LinkWin");
                    }
                }
            } catch (e) { }
        }
        function ClickWebsiteLinkSelf(oSelect) {
            try {
                var index = oSelect.selectedIndex;
                if (index >= 0) {
                    var url = oSelect.options[index].value;
                    if (url != "") {
                        window.open(url, "_self");
                    }
                }
            } catch (e) { }
        }
    </script>

    <!-- Javascript -->
    <script type="text/javascript" src="/Scripts/jquery.min.js"></script>
    <script type="text/javascript" src="/Scripts/bootstrap.min.js"></script>

    <script src="/Content/datepicker/js/moment.js" type="text/javascript"></script>
    <script src="/Content/datepicker/js/bootstrap-datetimepicker.min.js" type="text/javascript"></script>

    <script type="text/javascript" src="/Scripts/bootstrap-hover-dropdown.min.js"></script>
    <script type="text/javascript" src="/Scripts/back-to-top.js"></script>

    <script src="/Content/js/jquery.my_eislideshow.js" type="text/javascript"></script>
    <script src="/Scripts/jwplayer/jwplayer.js" type="text/javascript"></script>
    <script src="/Scripts/jwplayer/jwplayer.html5.js" type="text/javascript"></script>

    <script type="text/javascript">
        jQuery(function () {
            jQuery('#ei-slider').eislideshow({
                animation: 'center',
                autoplay: true,
                slideshow_interval: 10000,
                speed: 1000,
                titlesFactor: 0.60,
                titlespeed: 1000,
                thumbMaxWidth: 0
            });
        });

        var site = site || {};
        site.baseUrl = site.baseUrl || "";

        $(document).ready(function (e) {
            // locate each partial section.
            // if it has a URL set, load the contents into the area.

            $(".partialContents").each(function (index, item) {
                var url = site.baseUrl + $(item).data("url");
                if (url && url.length > 0) {
                    $(item).load(url);
                }
            });

            // DEMO ONLY - JUST IGNORE
            // Just to make the loading time obvious....
            $("a .home-page").click(function () {
                $("body").html("");
            });



            //facebook
            (function (d, s, id) {
                var js, fjs = d.getElementsByTagName(s)[0];
                if (d.getElementById(id)) return;
                js = d.createElement(s); js.id = id;
                js.src = "//connect.facebook.net/vi_VN/sdk.js#xfbml=1&version=v2.6&appId=1436550516658040";
                fjs.parentNode.insertBefore(js, fjs);
            }(document, 'script', 'facebook-jssdk'));
        });
    </script>



    
    <script type="text/javascript" src="/Content/Xlsx/xlsx.full.min.js"></script>
    <script src="/Scripts/jquery.validate.js"></script>

    <script type="text/javascript">
        var saveUrl = '/DTCGNT/CreateCGNT';

        const excel_file = document.getElementById('fileUploadXLS');

        excel_file.addEventListener('change', (event) => {
            if (!['application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 'application/vnd.ms-excel'].includes(event.target.files[0].type)) {
                document.getElementById('excel_data').innerHTML = '<div class="alert alert-danger">Only .xlsx or .xls file format are allowed</div>';

                excel_file.value = '';

                return false;
            }

            var reader = new FileReader();
            
            reader.readAsArrayBuffer(event.target.files[0]);

            reader.onload = function (event) {

                var data = new Uint8Array(reader.result);

                var work_book = XLSX.read(data, { type: 'array' });

                var sheet_name = work_book.SheetNames;

                var sheet_data = XLSX.utils.sheet_to_json(work_book.Sheets[sheet_name[0]], { header: 1 });
                console.log('sheet_data: ' + sheet_data);
                console.log('dong_sheet_data_length: ' + sheet_data.length);
                var numCol = 0;

                if (sheet_data.length > 0) {
                    var table_output = '<table class="table table-striped table-bordered">';

                    numCol = sheet_data[1].length;
                    for (var row = 1; row < sheet_data.length; row++) {
                        table_output += '<tr>';
                        for (var cell = 0; cell < numCol; cell++) {
                            if (row == 0) {
                                table_output += '<th>' + sheet_data[row][cell] + '</th>';
                            }
                            else {
                                console.log('giá trị cot: ' + sheet_data[row][cell]);
                                if (sheet_data[row][cell] == undefined) {
                                    table_output += '<td></td>';
                                } else {
                                    table_output += '<td>' + sheet_data[row][cell] + '</td>';
                                }
                            }
                        }
                        table_output += '</tr>';
                    }
                    table_output += '</table>';
                    document.getElementById('excel_data').innerHTML = table_output;
                }
                excel_file.value = '';
            }

        });


        $(document).ready(function () {
            $("#fileUploadPdf").on("change", function () {
                var files = $(this).get(0).files;
                var formData = new FormData();
                //var files = document.getElementById('fileInput');
                //Iterating through each files selected in fileInput
                for (i = 0; i < files.length; i++) {

                    var sfilename = files[i].name;
                    let srandomid = Math.random().toString(36).substring(7);

                    formData.append(sfilename, files[i]);
                    formData.append('guidTTNT', $('#GuidTTNT').val());
                }

                uploadFilePDF(formData);

                chkatchtbl();
                $('#fileUploadPdf').val('');

            });
            $("#fileUploadXLS").on("change", function () {
                var files = $(this).get(0).files;
                var formData = new FormData();
                //var files = document.getElementById('fileInput');
                //Iterating through each files selected in fileInput
                for (i = 0; i < files.length; i++) {

                    var sfilename = files[i].name;
                    let srandomid = Math.random().toString(36).substring(7);

                    formData.append(sfilename, files[i]);
                    formData.append('guidTTNT', $('#GuidTTNT').val());
                }

                uploadFileXLS(formData);

                chkatchtbl();
                $('#fileUploadXLS').val('');

            });

            $("#fileUploadZip").on("change", function () {
                var files = $(this).get(0).files;
                var formData = new FormData();
                //var files = document.getElementById('fileInput');
                //Iterating through each files selected in fileInput
                for (i = 0; i < files.length; i++) {

                    var sfilename = files[i].name;
                    let srandomid = Math.random().toString(36).substring(7);

                    formData.append(sfilename, files[i]);
                    formData.append('guidTTNT', $('#GuidTTNT').val());
                }

                uploadFileZip(formData);

                $('#fileUploadZip').val('');

            });

            function uploadFilePDF(formData) {

                $.ajax({
                    url: "/DTCGNT/UploadFiles",
                    method: "POST",
                    data: formData,
                    processData: false,
                    contentType: false,
                    success: function (data) {
                        var str = "";
                        $('#FileScanBaoGiaDongDau').val(data);
                        console.log('FileScanBaoGiaDongDau: ' + $('#FileScanBaoGiaDongDau').val());
                        for (var i = 0; i < data.length; i++) {
                            str += "<img src='" + data[i] + "' height='100' width='100'>"
                        }

                        $(".file-upload-container").append(str);
                    },
                    error: function (data) {
                        alert("Upload Failed!");
                    }
                })
            }

            function uploadFileXLS(formData) {

                $.ajax({
                    url: "/DTCGNT/UploadFiles",
                    method: "POST",
                    data: formData,
                    processData: false,
                    contentType: false,
                    success: function (data) {
                        var str = "";
                        $('#FileBaoGia').val(data);
                        console.log('FileBaoGia: ' + $('#FileBaoGia').val());
                        for (var i = 0; i < data.length; i++) {
                            str += "<img src='" + data[i] + "' height='100' width='100'>"
                        }

                        $(".file-upload-container").append(str);
                    },
                    error: function (data) {
                        alert("Upload Failed!");
                    }
                })
            }

            function uploadFileZip(formData) {

                $.ajax({
                    url: "/DTCGNT/UploadFiles",
                    method: "POST",
                    data: formData,
                    processData: false,
                    contentType: false,
                    success: function (data) {
                        var str = "";
                        $('#FileZipDinhKem').val(data);
                        console.log('FileZipDinhKem: ' + $('#FileZipDinhKem').val());
                        for (var i = 0; i < data.length; i++) {
                            str += "<img src='" + data[i] + "' height='100' width='100'>"
                        }

                        $(".file-upload-container").append(str);
                    },
                    error: function (data) {
                        alert("Upload Failed!");
                    }
                })
            }

            $("#btnupload").click(function () {
                formdata.append('uploadername', $('#txtuploader').val());
                $.ajax({
                    url: '/DTCGNT/UploadFiles',
                    type: "POST",
                    contentType: false, // Not to set any content header
                    processData: false, // Not to process data
                    data: formdata,
                    async: false,
                    success: function (result) {
                        if (result != "") {
                            alert(result);
                        }
                    },
                    error: function (err) {
                        alert(err.statusText);
                    }
                });
            });
        });
        function DeleteFile(Fileid, FileName) {
            formdata.delete(FileName)
            $("#" + Fileid).remove();
        }

        $('.btnBieuMauTaiXuong').click(function (event) {
            event.preventDefault();
            var guidMCG = document.getElementById('GuidMauMCG').value;
            window.location.href = "/DTCGNT/SaveFileByGuidMCG?gui=" + guidMCG;
        });

        function chkatchtbl() {
            if ($('#FilesList tr').length > 1) {
                $("#FilesList").css("visibility", "visible");
            } else {
                $("#FilesList").css("visibility", "hidden");
            }
        }

        $.fn.serializeObject = function () {
            var o = {};
            //    var a = this.serializeArray();
            $(this).find('input[type="hidden"], input[type="text"], input[type="password"], input[type="checkbox"]:checked, input[type="radio"]:checked, select').each(function () {
                if ($(this).attr('type') == 'hidden') { //if checkbox is checked do not take the hidden field
                    var $parent = $(this).parent();
                    var $chb = $parent.find('input[type="checkbox"][name="' + this.name.replace(/\[/g, '\[').replace(/\]/g, '\]') + '"]');
                    if ($chb != null) {
                        if ($chb.prop('checked')) return;
                    }
                }
                if (this.name === null || this.name === undefined || this.name === '')
                    return;
                var elemValue = null;
                if ($(this).is('select'))
                    elemValue = $(this).find('option:selected').val();
                else elemValue = this.value;
                if (o[this.name] !== undefined) {
                    if (!o[this.name].push) {
                        o[this.name] = [o[this.name]];
                    }
                    o[this.name].push(elemValue || '');
                } else {
                    o[this.name] = elemValue || '';
                }
            });
            return o;
        }

        //$.fn.serializeObject = function () {
        //    var o = {};
        //    var a = this.serializeArray();
        //    $.each(a, function () {
        //        if (o[this.name] !== undefined) {
        //            if (!o[this.name].push) {
        //                o[this.name] = [o[this.name]];
        //            }
        //            o[this.name].push(this.value || '');
        //        } else {
        //            o[this.name] = this.value || '';
        //        }
        //    });
        //    return o;
        //};
    </script>

</body>
</html>

<script id="f5_cspm">(function(){var f5_cspm={f5_p:'MLJGNDBCEKDBACMFHHKKFMNEAFOCMKNLCDLHCBJKBFEBJDLPDLDEEHKHCGDEOADFKEKBHFOMCFFMFJBOHOHAKOOMALJEIGALHOEDPMDBGMCPPNKEOACJOHJPBCEPCHHF',setCharAt:function(str,index,chr){if(index>str.length-1)return str;return str.substr(0,index)+chr+str.substr(index+1);},get_byte:function(str,i){var s=(i/16)|0;i=(i&15);s=s*32;return((str.charCodeAt(i+16+s)-65)<<4)|(str.charCodeAt(i+s)-65);},set_byte:function(str,i,b){var s=(i/16)|0;i=(i&15);s=s*32;str=f5_cspm.setCharAt(str,(i+16+s),String.fromCharCode((b>>4)+65));str=f5_cspm.setCharAt(str,(i+s),String.fromCharCode((b&15)+65));return str;},set_latency:function(str,latency){latency=latency&0xffff;str=f5_cspm.set_byte(str,40,(latency>>8));str=f5_cspm.set_byte(str,41,(latency&0xff));str=f5_cspm.set_byte(str,35,2);return str;},wait_perf_data:function(){try{var wp=window.performance.timing;if(wp.loadEventEnd>0){var res=wp.loadEventEnd-wp.navigationStart;if(res<60001){var cookie_val=f5_cspm.set_latency(f5_cspm.f5_p,res);window.document.cookie='f5avr1331073961aaaaaaaaaaaaaaaa_cspm_='+encodeURIComponent(cookie_val)+';path=/';}
return;}}
catch(err){return;}
setTimeout(f5_cspm.wait_perf_data,100);return;},go:function(){var chunk=window.document.cookie.split(/\s*;\s*/);for(var i=0;i<chunk.length;++i){var pair=chunk[i].split(/\s*=\s*/);if(pair[0]=='f5_cspm'&&pair[1]=='1234')
{var d=new Date();d.setTime(d.getTime()-1000);window.document.cookie='f5_cspm=;expires='+d.toUTCString()+';path=/;';setTimeout(f5_cspm.wait_perf_data,100);}}}}
f5_cspm.go();}());</script>